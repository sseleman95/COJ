int factMod (int n, int p) {
   int res = 1,i;
   while (n > 1) {
      if ((n/p) & 1)
      res = (res * (p-1)) % p;
      for (i=n%p; i > 1;i--)
         res = (res * i) % p;
      n /= p;
   }
   return res % p;
}
